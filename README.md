# VKR
Этот проект представляет собой API-сервис для классификации изображений
мусорных баков с использованием модели машинного обучения Vision Transformer (ViT).

## Выпускная квалификационная работа

**_Цель:_** Разработка системы компьютерного 
зрения для автоматической классификации состояния мусорных контейнеров 
и площадок крупногабаритных отходов на основе изображений с 
фотоловушек, 
обеспечивающей высокую точность распознавания 
взаимоисключающих и комбинированных классов.

## Функциональность

Сервис может определять следующие классы:
- Переполненные/не переполненные контейнеры ТКО
- Переполненная/не переполненная площадка КГО
- Исправность оборудования
- Состояние крышек контейнеров
- Расположение контейнеров
- И другие характеристики мусорных баков

## Требования

- Python 3.8+
- Docker

## Установка и запуск

### Локальный запуск

1. Клонируйте репозиторий:
```bash
git clone <https://github.com/danilarkhipov1/VKR.git>
cd VKR
```

2. Установите зависимости:
```
pip install -r requirements.txt
```

3. Запустите сервис:
```
uvicorn src.main:app --host 0.0.0.0 --port 8000
```

### Запуск через Docker
1. Соберите Docker-образ:
```
docker build -t waste-classifier .
```
2. Запустите контейнер:
```
docker run -p 8000:8000 waste-classifier
```
## Использование API
### Проверка работоспособности
```
curl http://localhost:8000/
```
### Классификация изображения
```
curl -X POST http://localhost:8000/predict \
  -H "Content-Type: multipart/form-data" \
  -F "file=@path/to/your/image.jpg"
```
### Формат ответа
```
{
  "predictions": [
    {
      "class": "переполненные ТКО",
      "confidence": 0.95
    }
  ],
  "number_of_classes": 1
}
```

-Структура проекта_
```
VKR/
├── src/
│   ├── main.py        # FastAPI приложение
│   ├── models.py      # Модель классификатора
│   └── utils.py       # Вспомогательные функции
├── models/
│   └── model.pt       # Веса модели
├── requirements.txt   # Зависимости проекта
├── Dockerfile        # Конфигурация Docker
└── README.md        # Документация
```

## Примечания
- Модель использует архитектуру Vision Transformer (ViT)
- Поддерживается многоклассовая классификация
- API построено с использованием FastAPI

